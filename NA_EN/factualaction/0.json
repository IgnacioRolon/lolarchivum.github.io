{"poster":"FactualAction","date":"2014-12-08T18:19:10.755+0000","title":"Shop refund resets gealth to level it was at when shop page was opened","subforum":"Report a Bug","embed":{"description":"-- Watch live at http://www.twitch.tv/trick2g","url":"https://www.youtube.com/watch?v=pOg6SDds4G0","image":"/api/embedly/1/image/resize?url=http://i.ytimg.com/vi/pOg6SDds4G0/hqdefault.jpg&key=a45e967db0914c7fb472fd4381e6c85b&width=425"},"up_votes":12,"down_votes":2,"body":"I've noticed that occasionally when I refund an item (like a potion or a ward) I take a ton of damage.  You can see the same bug happen to Trick2g at 1:30 in the video I linked where he refunds a potion and takes 300ish damage.  After some testing in custom games, I think I have a way to consistently reproduce the bug:\r\n\r\n1 Take in a lot of damage in a custom game, down to something like 10% of max.\r\n2 While casting the recall, open the shop and try to buy an item continuously while recalling. Any item works.\r\n3 Once you are back at the pool, let yourself regen.\r\n4 Stay in the pool and return/refund the item you just bought while watching your health.\r\n5 See tons of damage from refunding the item.\r\n\r\nIt's not usually a game breaking bug, but it forces me to sit in the fountain an extra 5ish seconds so I can regen health that I already regenerated, and those seconds can make a big difference when trying to get back to lane.","replies":[{"poster":"Riot Afic","date":"2014-12-08T22:57:40.662+0000","up_votes":8,"down_votes":1,"body":"Thanks for this report!  \n\nAlthough this isn't ideal, it is actually intended.\n\nGonna go into waaaay too much detail, but if you are curious read on!\nThe first reason it was implemented this way is to prevent players from buying/undoing item buys to heal faster.  The way it works, is when you buy an item with health, the game will increase your max health, and then on the next tick heals you for an amount equal to the amount of health you gained.  The obvious solution is then on item undo, also reduce your current health by the amount of health the item had.  The problem with this solution is with the old item Spirit of the Ancient Golem (which gave you more health based on a % of your current max health).   This made it so the amount of health an item gave wasn't always the same, and ultimately the current implementation is a result of that.  We could probably address this (there are likely other abuse cases I am missing) but there is also a possibility we introduce another item with a similar effect, in which case this bug will return.\n\nTL;DR the game will remember your health when you buy an item, and revert to that value after an undo.\n\nAgain, this isn't ideal, but I hope it at least gives some insight into why it is this way.\n\nHope this helps!","replies":[{"poster":"Eotw","date":"2014-12-08T23:13:30.985+0000","up_votes":4,"down_votes":0,"body":"Why doesn't it just maintain the % of max HP?  For instance, regardless of whether the health increases or decreases, if you had 10% of your max HP before, you'd have 10% afterwards.","replies":[]},{"poster":"TheKingDodo","date":"2014-12-09T00:16:31.907+0000","up_votes":2,"down_votes":0,"body":"> Thanks for this report!  \n> \n> Although this isn't ideal, it is actually intended.\n> \n> Gonna go into waaaay too much detail, but if you are curious read on!\n> The first reason it was implemented this way is to prevent players from buying/undoing item buys to heal faster.  The way it works, is when you buy an item with health, the game will increase your max health, and then on the next tick heals you for an amount equal to the amount of health you gained.  The obvious solution is then on item undo, also reduce your current health by the amount of health the item had.  The problem with this solution is with the old item Spirit of the Ancient Golem (which gave you more health based on a % of your current max health).   This made it so the amount of health an item gave wasn't always the same, and ultimately the current implementation is a result of that.  We could probably address this (there are likely other abuse cases I am missing) but there is also a possibility we introduce another item with a similar effect, in which case this bug will return.\n> \n> TL;DR the game will remember your health when you buy an item, and revert to that value after an undo.\n> \n> Again, this isn't ideal, but I hope it at least gives some insight into why it is this way.\n> \n> Hope this helps!\n\nWhy not just have it apply to health/mana/regen/homeguards items only? I lose health when I undo buy a long sword. and that's just outrageous {{champion:44}} truly truly...","replies":[]},{"poster":"ShadowGlaive213","date":"2014-12-09T21:19:39.375+0000","up_votes":1,"down_votes":0,"body":"I was in a bot game as Lux earlier and I refunded my grail (not a health item) for spell pen boots and I lost health though =X","replies":[]},{"poster":"GundayMonday","date":"2014-12-08T23:45:04.413+0000","up_votes":1,"down_votes":0,"body":"I guess that makes sense. Thanks for the explanation!","replies":[]},{"poster":"kayakninja","date":"2014-12-08T23:33:42.570+0000","up_votes":1,"down_votes":0,"body":"Now that Spirit of the Ancient Golem is out of the game, do you think we're going to see this change?","replies":[]}]},{"poster":"Coffee Ray Gun","date":"2014-12-08T19:03:55.332+0000","up_votes":4,"down_votes":0,"body":"I think it resets you to the state you were in when you bought the item, I wonder if buying an item while a debuff is on you (e.g. Morde's ult) and then undoing would reset the debuff.\n\nAlso, there's a small typo in the thread title, see if you can find it :3.","replies":[{"poster":"FactualAction","date":"2014-12-08T19:14:54.625+0000","up_votes":1,"down_votes":0,"body":"Yeah I noticed it the moment I posted it.  Sadly I can't edit the title to fix it.\n\nLooks like you're right, it resets to state of purchase.  Still a pretty bad bug imo.","replies":[]}]},{"poster":"Be Kind Rewind","date":"2014-12-08T21:04:31.255+0000","up_votes":1,"down_votes":1,"body":"Why do you think it's a bug?  I was always pretty sure it was intentional.  \nWhat if you buy an HP5 item, and then resell it a few moments later?  You keep all the hp regen it just gave you temporarily?  \nWhat about the same for mana regen?  \nWhat about weird situations like buying a tank item, getting hit in the fountain, then re-selling it?  You get to have tanked temporarily, without paying for the item?  \nHeck, what about flat max HP / max Mana boosting items?  How would you handle % regen with those?  Imagine buying something like chalice and tear.  Mana font increases your mana, and the tear's max mana increase makes Mana font increase it even more rapidly.  So then you resell them both and get to have all of that mana restore, temporarily, for free?\n\nThese might sound silly and insignificant, but I'm pretty sure the whole point is to avoid these situations.  **It makes sure you didn't get any unfair advantage by temporarily owning an item before re-selling it - by just reverting you to your pre-item-buy state.  **\n\nI think the reason it seems like a glitch is because it's shown as if you actually just *took* damage, though, instead of just reverting back to a different health amount.","replies":[{"poster":"Eotw","date":"2014-12-08T23:20:18.022+0000","up_votes":2,"down_votes":0,"body":"Most of what you described, such as the mana font, is so insignificant that if you want to micromanage yourself to that extent, you deserve the 1/4 second you might save.  You'll probably sacrifice it in other ways before you even leave the fountain.\n\nAs for the rest, if you get hit in the fountain, you should not be able to undo.","replies":[{"poster":"Be Kind Rewind","date":"2014-12-09T00:47:02.568+0000","up_votes":1,"down_votes":0,"body":"I'm not saying it's practical or even necessary.  But as described by the Red post in this thread, it seems that is essentially the reason for the feature.\n\nAlso, to be fair, I think it is necessary.  It has a very minimal impact, sure.  But so does, for example, move-attacking jungle monsters as a pure melee in the jungle.  The slight delay it gives the monsters makes you survive with slightly more health, and puts you slightly closer to the next camp.  So the pros have all done it.  In cases of emergency, you don't suppose pros would buy a massive health regen item, to get out of base ASAP, then dump them quickly once they're about full?\n\nFor context; there was a game in this last LCS season, I believe, where one team was literally **one auto-attack from taking the nexus.**  But the last surviving enemy got out of the fountain just in time to save the nexus.  And then they came back and won.\n\nThat's a fringe case, but what if, for example, that \"last-hit on the nexus\" comes down to, \"I grabbed a spirit visage, then re-sold it briefly and barely won the fight by 50 hp, saving the nexus.\"\n\nThat seems unlikely.   But if they can prevent that from happening, why not?  So that we don't feel like we're taking damage when we refund stuff?  Do you want them to let the issue remain just because it doesn't feel like it will probably become significant?","replies":[{"poster":"Eotw","date":"2014-12-09T01:19:06.366+0000","up_votes":2,"down_votes":0,"body":"Let's put a number to that feeling.  My entire point revolves around the fact that, unlike move-attacking in the jungle, you wouldn't get any benefit by spending the time to do it.\n\nThe best item to increase health regen is Warmog's by far at 3% HP per 5 seconds.  You recover 2.1% of your max HP every 0.25 seconds while in spawn, which equates to 12 seconds to fully heal.  In this time, you could potentially heal 7% of your health from Warmog's, saving *half a second* in the absolute best case scenario.\n\nBut wait!  If you sell the Warmog's, you'll have nearly 3k gold sitting in your inventory.  No pro would leave fountain with that kind of cash.  That means that you have to *buy the item you want after selling Warmog's*.  Realistically, even the pros wouldn't be able to gain more than 1/4 of a second doing this.  And this is time they focused on micromanaging spawn instead of scoping out the map!\n\nIf you still want to argue that it's significant, the obvious solution is to disable health and mana regen while in spawn outside of the spawn's regen itself.","replies":[{"poster":"Be Kind Rewind","date":"2014-12-09T01:26:19.689+0000","up_votes":1,"down_votes":0,"body":"> Let's put a number to that feeling.  My entire point revolves around the fact that, unlike move-attacking in the jungle, you wouldn't get any benefit by spending the time to do it.\n> \n> The best item to increase health regen is Warmog's by far at 3% HP per 5 seconds.  You recover 2.1% of your max HP every 0.25 seconds while in spawn, which equates to 12 seconds to fully heal.  In this time, you could potentially heal 7% of your health from Warmog's, saving *half a second* in the absolute best case scenario.\n> \n> But wait!  If you sell the Warmog's, you'll have nearly 3k gold sitting in your inventory.  No pro would leave fountain with that kind of cash.  That means that you have to *buy the item you want after selling Warmog's*.  Realistically, even the pros wouldn't be able to gain more than 1/4 of a second doing this.  And this is time they focused on micromanaging spawn instead of scoping out the map!\n> \n> If you still want to argue that it's significant, the obvious solution is to disable health and mana regen while in spawn outside of the spawn's regen itself.\n\nNo, my argument isn't that it's significant.  My argument is that, *\"it's an insignificant issue therefore Riot shouldn't fix it\"* is a bad argument.  It's a small issue that could have more severe implications in the future depending on itemization changes, that Riot prevents from being an issue with the current system.  The only problem is feeling weird about having it 'damage you' back to your prior health, or the slight moment longer it'll take you to get out of fountain due to the refund.  But if you're sitting around, buying an item, waiting a bit, then refunding it, urgency is clearly not an issue.","replies":[{"poster":"Eotw","date":"2014-12-09T01:50:59.423+0000","up_votes":2,"down_votes":0,"body":"When the fix is worse than the issue, \"Riot shouldn't fix it\" is very reasonable.\n\nIf Riot is going to fix it, they should fix it properly.  Like I said, health and mana regen can simply be disabled while in spawn.","replies":[]}]}]}]}]},{"poster":"GundayMonday","date":"2014-12-08T21:14:48.091+0000","up_votes":2,"down_votes":0,"body":"Here's a video of it happening to me. Bought a red pot. Didn't use it, refunded it. Down ~1k hp:\nhttps://www.youtube.com/watch?v=uY_46Pp-ejs","replies":[]}]},{"poster":"FactualAction","date":"2014-12-08T19:12:43.810+0000","up_votes":1,"down_votes":0,"body":"Looks like Coffee Ray Gun is right, it's health state at item purchase, not shop page open.  Still a bug! :)","replies":[{"poster":"Coffee Ray Gun","date":"2014-12-08T19:14:55.055+0000","up_votes":2,"down_votes":1,"body":"I don't think it's a bug so much as it's an oversight, still needs to be fixed no matter what it's called xD.","replies":[]}]},{"poster":"TheKingDodo","date":"2014-12-08T22:06:32.730+0000","up_votes":1,"down_votes":0,"body":"Been around for 2 months apparently:\nhere's the necro thread: http://boards.na.leagueoflegends.com/en/c/bug-report/9jcdoKO1-bug-report-refunding-items-causing-healthmana-resets","replies":[]},{"poster":"GundayMonday","date":"2014-12-08T21:13:00.607+0000","up_votes":1,"down_votes":0,"body":"Happened to me last night. Messed up a teamfight when I had WAY less health than expected.\nhttps://www.youtube.com/watch?v=uY_46Pp-ejs","replies":[]}]}